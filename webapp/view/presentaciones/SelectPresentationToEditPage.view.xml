<mvc:View
    controllerName="com.invertions.sapfiorimodinv.controller.presentaciones.SelectPresentationtoEditPage"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:l="sap.ui.layout"
    xmlns:core="sap.ui.core">

    <Page
        id="selectPresentationPage"
        title="{i18n>selectPresentationPageTitle}"
        showNavButton="true"
        navButtonPress=".onNavBack">

        <!-- HEADER: switch modo múltiple + botón eliminar -->
        <headerContent>
            <Switch
                id="multiModeSwitch"
                customTextOn="Múltiple"
                customTextOff="Simple"
                state="{selectModel>/multiMode}"
                change="onMultiModeChange" />
            <Button
                icon="sap-icon://delete"
                text="Eliminar ({= ${selectModel>/selectedIds}.length })"
                type="Negative"
                press="onOpenBulkDelete"
                visible="{= ${selectModel>/multiMode} &amp;&amp; ${selectModel>/selectedIds}.length > 0 }" />
        </headerContent>

        <content>
            <VBox class="sapUiSmallMargin">

                <!-- Select All -->
                <Toolbar visible="{= ${selectModel>/multiMode} }">
                    <CheckBox
                        text="Seleccionar todo"
                        select="onSelectAll"
                        visible="{= ${selectModel>/presentations}.length > 0 }" />
                </Toolbar>

                <!-- Loading -->
                <BusyIndicator
                    busy="{selectModel>/loading}"
                    class="sapUiMediumMarginTop" />

                <!-- Sin datos -->
                <IllustratedMessage
                    visible="{= !${selectModel>/loading} &amp;&amp; ${selectModel>/presentations}.length === 0 }"
                    illustrationType="sapIllus-EmptyList"
                    title="{i18n>selectPresentationNoDataTitle}"
                    description="{i18n>selectPresentationNoDataDesc}" />

                <!-- Error -->
                <Text
                    text="{selectModel>/error}"
                    class="sapUiNegativeText sapUiSmallMargin"
                    visible="{= !!${selectModel>/error} }" />

                <!-- TARJETAS EN FLEXBOX -->
                <ScrollContainer
                    height="100%"
                    horizontal="false"
                    vertical="true"
                    visible="{= !${selectModel>/loading} &amp;&amp; ${selectModel>/presentations}.length > 0 }">

                    <f:GridContainer
                        class="sapUiSmallMarginTop"
                        items="{selectModel>/presentations}">
                        <f:layout>
                            <f:GridContainerSettings rowSize="5rem" columnSize="24rem" gap="1rem" />
                        </f:layout>
                        <f:items>
                            <f:Card
                                class="sapUiMediumMarginBottom"
                                press=".onCardPress(${$parameters>/srcControl})">

                                <f:content>
                                    <VBox class="sapUiSmallMargin">

                                        <!-- Título + checkbox -->
                                        <HBox
                                            justifyContent="SpaceBetween"
                                            alignItems="Center"
                                            class="sapUiTinyMarginBottom">

                                            <VBox width="100%">
                                                <Title
                                                    text="{selectModel>NOMBREPRESENTACION}"
                                                    level="H5"
                                                    wrapping="true" />
                                                <Text
                                                    text="{selectModel>IdPresentaOK}"
                                                    class="sapUiTinyMarginTop"
                                                    wrapping="true" />
                                            </VBox>

                                            <!-- Checkbox sólo en modo múltiple -->
                                            <CheckBox
                                                selected="{selectModel>selected}"
                                                select="onToggleOne"
                                                visible="{= ${selectModel>/multiMode} }"
                                                tooltip="Seleccionar" />
                                        </HBox>

                                        <!-- Descripción completa -->
                                        <Text
                                            text="{selectModel>Descripcion}"
                                            wrapping="true"
                                            class="sapUiTinyMarginBottom" />

                                        <!-- Estado + botones Editar / Eliminar -->
                                
                                        <HBox
                                            justifyContent="SpaceBetween"
                                            alignItems="Center"
                                            class="sapUiTinyMarginTop">

                                            <ObjectStatus
                                                text="{= ${selectModel>ACTIVED} ? 'Activa' : 'Inactiva' }"
                                                state="{= ${selectModel>ACTIVED} ? 'Success' : 'Warning' }" />

                                            <!-- Botones sólo en modo simple -->
                                            <HBox visible="{= !${selectModel>/multiMode} }">
                                                <Button
                                                    icon="sap-icon://edit"
                                                    type="Transparent"
                                                    tooltip="Editar"
                                                    press="onEditPress" />
                                                <Button
                                                    icon="sap-icon://delete"
                                                    type="Transparent"
                                                    tooltip="Eliminar"
                                                    press="onOpenSingleDelete" />
                                            </HBox>
                                        </HBox>


                                    </VBox>
                                </f:content>
                            </f:Card>
                        </f:items>
                    </f:GridContainer>
                </ScrollContainer>

            </VBox>
        </content>
    </Page>
</mvc:View>
